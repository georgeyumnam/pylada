if(do_tests)
  if(DEFINED MPI_CXX_COMPILER)
    add_executable (pifunc functional.cc)
    include_directories(${MPI_CXX_INCLUDE_PATH})
    target_link_libraries(pifunc ${MPI_CXX_LIBRARIES} ${PYTHON_LIBRARIES})
    
    add_test(process_pifunc ${MPIEXEC} pifunc --order 4)
    add_test(process_program python ${CMAKE_CURRENT_SOURCE_DIR}/program.py ${CMAKE_CURRENT_BINARY_DIR}/pifunc)
    add_test(process_call python ${CMAKE_CURRENT_SOURCE_DIR}/call.py ${CMAKE_CURRENT_BINARY_DIR}/pifunc)
    add_test(process_iterator python ${CMAKE_CURRENT_SOURCE_DIR}/iterator.py ${CMAKE_CURRENT_BINARY_DIR}/pifunc)
    if(jobfolder_package)
      add_test(process_pool python ${CMAKE_CURRENT_SOURCE_DIR}/pool.py ${CMAKE_CURRENT_BINARY_DIR}/pifunc)
      add_test(process_jobfolder python ${CMAKE_CURRENT_SOURCE_DIR}/jobfolder.py ${CMAKE_CURRENT_BINARY_DIR}/pifunc)
    endif(jobfolder_package)
  endif(DEFINED MPI_CXX_COMPILER)

endif(do_tests)
