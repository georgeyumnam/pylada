

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Extracting results from VASP calculations &mdash; Pylada 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="top" title="Pylada 1.0 documentation" href="../../index.html" />
    <link rel="up" title="Interface to VASP" href="../vasp.html" />
    <link rel="next" title="A meta-functional: Strain relaxation" href="relax.html" />
    <link rel="prev" title="Executing a VASP calculation" href="running.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="relax.html" title="A meta-functional: Strain relaxation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="running.html" title="Executing a VASP calculation"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">Pylada 1.0 documentation</a> &raquo;</li>
          <li><a href="../../userguide.html" >User Guide</a> &raquo;</li>
          <li><a href="../vasp.html" accesskey="U">Interface to VASP</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="extracting-results-from-vasp-calculations">
<span id="vasp-extracting-ug"></span><h1>Extracting results from VASP calculations<a class="headerlink" href="#extracting-results-from-vasp-calculations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="exctracting-from-a-single-calculation">
<h2>Exctracting from a single calculation<a class="headerlink" href="#exctracting-from-a-single-calculation" title="Permalink to this headline">¶</a></h2>
<p>Launching a calculation is not everything. One wants the results. Pylada makes it
easy to interface with those results directly in the python language. Every
functional in Pylada returns an extraction object capable of grepping the
relevant output.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">vasp</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">result</span><span class="o">.</span><span class="n">eigenvalues</span> <span class="o">*</span> <span class="mi">2</span>
<span class="go">[5, 6, 7] * eV</span>
</pre></div>
</div>
<p>The above checks that the calculation ran to completion, and then multiplies
the eigenvalues by two. At this point, one could perform any sort of
post-processing, and then automatically launch a subsequent calculation.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Success means the calculation ran to completion, specifically that the lines
giving the elapsed time exist in the OUTCAR. It does not mean that the
results are meaningful.</p>
</div>
<p>The extraction object can be obtained without rerunning <a class="reference external" href="http://www.vasp.at/">VASP</a>. There are to
ways to go about this. One is, well, to rerun (but without rerunning, if that
makes sense):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># first time, vasp is executed, presumably.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">vasp</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">outdir</span><span class="o">=</span><span class="s">&#39;mycalc&#39;</span><span class="p">,</span> <span class="n">ispin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># abort if not successful</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">...</span> <span class="n">do</span> <span class="n">something</span> <span class="o">...</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># second time, OUTCAR exists. It is NOT overwritten.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># The extraction object is returned immediately.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">vasp</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">outdir</span><span class="o">=</span><span class="s">&#39;mycalc&#39;</span><span class="p">,</span> <span class="n">ispin</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>In the example above, <a class="reference external" href="http://www.vasp.at/">VASP</a> is actually launched the first time. However, on the
second pass, an OUTCAR is found. If it is a successful run, then Pylada will
<em>not</em> overwrite it. It does not matter whether the structure has changed, or
whether the <a class="reference external" href="http://www.vasp.at/">VASP</a> parameters are different. Pylada will <em>never</em> overwrite a
successful run. Not unless specifically requested to. The returned extraction
object corresponds to the OUTCAR. Hence, on the second pass, it is the results
of the first call which are returned. Unless, of course, a successful
calculation already existed there prior to the first run, in which case Pylada
would <em>never ever</em> have been so crass as to overwrite it.</p>
<p>The second method is to create an extraction object directly:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pylada.vasp</span> <span class="kn">import</span> <span class="n">Extract</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">Extract</span><span class="p">(</span><span class="s">&#39;/path/to/directory&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In the above, it is expected that the OUTCAR is called OUTCAR. The path can
also be made to a file with a name other than OUTCAR.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">An extraction object can be created for any OUTCAR, whether obtained <em>via</em>
Pylada or not. Some information that Pylada automatically appends to an OUTCAR
may not be obtainable, however.</p>
</div>
<p>To find out what Pylada can extract, do <tt class="docutils literal"><span class="pre">result.[TAB]</span></tt> in the <a class="reference external" href="http://ipython.org/">ipython</a>
environment. Or checkout <a class="reference internal" href="../../pyapi/vasp/extract.html#pylada.vasp.extract.Extract" title="pylada.vasp.extract.Extract"><tt class="xref py py-class docutils literal"><span class="pre">Extract</span></tt></a>.</p>
<p>If you know how to use <a class="reference external" href="http://docs.python.org/library/re.html">regular expressions</a>, creating a property like those above
is generally fairly simple. Edit the file &#8220;vasp/extract/base.py&#8221;, reinstall,
and you&#8217;re golden. And send your snippet back this way.</p>
</div>
<div class="section" id="extracting-results-from-many-calculations-and-plotting-stuff">
<span id="vasp-massextract-ug"></span><h2>Extracting results from <em>many</em> calculations, and plotting stuff<a class="headerlink" href="#extracting-results-from-many-calculations-and-plotting-stuff" title="Permalink to this headline">¶</a></h2>
<p>Pylada arranges all calculations within directories, with a single VASP
calculation per sub-directory. It can be expedient to extract simultaneously
all the results contained within a directory and its subdirectories. One
approach is to use <a class="reference internal" href="../jobfolders.html#jobfolder-ug"><em>jobfolders</em></a> and the <a class="reference internal" href="../ipython.html#ipython-ug"><em>ipython
interface</em></a>. Failing that, however, it still possible to extract
all the results within a tree of directories simultaneously. When used in
conjunction with plotting software such as <a class="reference external" href="http://matplotlib.sourceforge.net/">matplotlib</a>, it makes it really easy
to synthesize and understand the results from a set of calculations.
It all comes down to a few simple lines:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pylada.vasp</span> <span class="kn">import</span> <span class="n">MassExtract</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">MassExtract</span><span class="p">(</span><span class="s">&#39;some/path&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">total_energies</span>
<span class="go">{</span>
<span class="go">   &#39;/this/path/&#39;:  array(-666.667) * eV,</span>
<span class="go">   &#39;/that/path/&#39;:  array(-999.998) * eV</span>
<span class="go">}</span>
</pre></div>
</div>
<p>&#8220;this/path&#8221; and &#8220;that/path&#8221; are directories in &#8220;some/path&#8221; where OUTCAR files
exist.  The return is a
<a class="reference internal" href="../../pyapi/jobfolder/forwardingdict.html#pylada.jobfolder.forwarding_dict.ForwardingDict" title="pylada.jobfolder.forwarding_dict.ForwardingDict"><tt class="xref py py-class docutils literal"><span class="pre">ForwardingDict</span></tt></a> instance. It is
possible to string together attributes to get to those of interest:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">scale</span>
<span class="go">{</span>
<span class="go">   &#39;/this/path/&#39;:  5.45,</span>
<span class="go">   &#39;/that/path/&#39;:  5.65</span>
<span class="go">}</span>
</pre></div>
</div>
<p>From there, it is one simple step to plot, say, energies with respect to the
scale (first, run ipython with the <tt class="docutils literal"><span class="pre">-pylab</span></tt> flag to import <a class="reference external" href="http://matplotlib.sourceforge.net/">matplotlib</a>
related stuff, or run the ipython notebook app):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">scale</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">total_energies</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
<p><a class="reference internal" href="../../pyapi/vasp/extract.html#pylada.vasp.extract.MassExtract" title="pylada.vasp.extract.MassExtract"><tt class="xref py py-class docutils literal"><span class="pre">MassExtract</span></tt></a> behaves exactly like the
<a class="reference internal" href="../ipython.html#ipython-collect-ug"><em>collect</em></a> object.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Extracting results from VASP calculations</a><ul>
<li><a class="reference internal" href="#exctracting-from-a-single-calculation">Exctracting from a single calculation</a></li>
<li><a class="reference internal" href="#extracting-results-from-many-calculations-and-plotting-stuff">Extracting results from <em>many</em> calculations, and plotting stuff</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="running.html"
                        title="previous chapter">Executing a VASP calculation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="relax.html"
                        title="next chapter">A <em>meta</em>-functional: Strain relaxation</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/userguide/vasp/extract.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="relax.html" title="A meta-functional: Strain relaxation"
             >next</a> |</li>
        <li class="right" >
          <a href="running.html" title="Executing a VASP calculation"
             >previous</a> |</li>
        <li><a href="../../index.html">Pylada 1.0 documentation</a> &raquo;</li>
          <li><a href="../../userguide.html" >User Guide</a> &raquo;</li>
          <li><a href="../vasp.html" >Interface to VASP</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Mayeul d&#39;Avezac.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>