

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Creating and Setting up the vasp functional &mdash; Pylada 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="top" title="Pylada 1.0 documentation" href="../../index.html" />
    <link rel="up" title="Interface to VASP" href="../vasp.html" />
    <link rel="next" title="Executing a VASP calculation" href="running.html" />
    <link rel="prev" title="Reading from pre-existing VASP files" href="reading.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="running.html" title="Executing a VASP calculation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="reading.html" title="Reading from pre-existing VASP files"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">Pylada 1.0 documentation</a> &raquo;</li>
          <li><a href="../../userguide.html" >User Guide</a> &raquo;</li>
          <li><a href="../vasp.html" accesskey="U">Interface to VASP</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="creating-and-setting-up-the-vasp-functional">
<span id="vasp-creating-ug"></span><h1>Creating and Setting up the vasp functional<a class="headerlink" href="#creating-and-setting-up-the-vasp-functional" title="Permalink to this headline">¶</a></h1>
<div class="section" id="specifying-vasp-parameters">
<h2>Specifying vasp parameters<a class="headerlink" href="#specifying-vasp-parameters" title="Permalink to this headline">¶</a></h2>
<p>As shown in the quick primer above, it is relatively easy to setup a new
<tt class="xref py py-class docutils literal"><span class="pre">Vasp</span></tt>. The parameters to the calculation are generally
the <a class="reference external" href="http://www.vasp.at/">VASP</a> defaults. They can be changed directly in the constructor:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pylada.vasp</span> <span class="kn">import</span> <span class="n">Vasp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vasp</span> <span class="o">=</span> <span class="n">Vasp</span><span class="p">(</span><span class="n">ispin</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">vasp</span><span class="o">.</span><span class="n">ispin</span>
<span class="go">2</span>
</pre></div>
</div>
<p>or later, after creation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vasp</span><span class="o">.</span><span class="n">ispin</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">vasp</span><span class="o">.</span><span class="n">ispin</span>
<span class="go">2</span>
</pre></div>
</div>
<p>or even right at the moment when executing a calculation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vasp</span><span class="o">.</span><span class="n">encut</span> <span class="o">=</span> <span class="mf">1.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">vasp</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">ispin</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">encut</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">vasp</span><span class="o">.</span><span class="n">encut</span>
<span class="go">1.2</span>
</pre></div>
</div>
<p>In the line above, vasp is called with <tt class="docutils literal"><span class="pre">ispin=2</span></tt> and <tt class="docutils literal"><span class="pre">encut=1</span></tt>. However,
specifying a vasp parameter directly at execution <em>does</em> not modify the vasp
object itself, as indicated by the third line. The parameter is only modified
for the duration of the run and not beyond.</p>
<p>At this point, it might have come as a surprise to see <tt class="docutils literal"><span class="pre">encut=1</span></tt>. What units
are we talking about here? A number of parameters have enhanced behaviors with
respect to the original <a class="reference external" href="http://www.vasp.at/">VASP</a> code, in order to make it easier to specify
parameters valid for many calculations. <tt class="xref py py-attr docutils literal"><span class="pre">encut</span></tt>
one of those. It can be specified:</p>
<blockquote>
<div><ul>
<li><p class="first">as floating point smaller than 3, in which case it is a factor of the
largest <cite>ENMAX</cite> of all the species in the calculation.</p>
</li>
<li><p class="first">as floating point larger than 3, in which case it will printed as is in the INCAR.</p>
</li>
<li><p class="first">as floating point signed by a quantity:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pylada.physics</span> <span class="kn">import</span> <span class="n">Ry</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vasp</span><span class="o">.</span><span class="n">encut</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">Ry</span>
</pre></div>
</div>
<p>In that case, the result will be converted to electron-Volts in the INCAR.</p>
</li>
</ul>
</div></blockquote>
<p>To see the full list of parameters  defined by Pylada, do <tt class="docutils literal"><span class="pre">vasp.[TAB]</span></tt> on the
<a class="reference external" href="http://ipython.org/">ipython</a> command line, or go <a class="reference internal" href="../../pyapi/vasp/functional.html#pylada.vasp.functional.Vasp" title="pylada.vasp.functional.Vasp"><tt class="xref py py-class docutils literal"><span class="pre">Vasp</span></tt></a>.</p>
</div>
<div class="section" id="adding-parameters-pylada-does-not-know-about">
<h2>Adding parameters Pylada does not know about<a class="headerlink" href="#adding-parameters-pylada-does-not-know-about" title="Permalink to this headline">¶</a></h2>
<p>A large number of parameters control <a class="reference external" href="http://www.vasp.at/">VASP</a>. Pylada only knows about the most
common. However, it is fairly easy to add parameters which are not there yet.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vasp</span><span class="o">.</span><span class="n">add_keyword</span><span class="p">(</span><span class="s">&#39;encut&#39;</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
<p>This will add a parameter to VASP. It will appear in the incar as &#8220;ENCUT =
300&#8221;, with the tag name in uppercase. The parameter can be later accessed and
modified just as if it where a pre-existing parameter.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">vasp</span><span class="o">.</span><span class="n">encut</span>
<span class="go">300</span>
</pre></div>
</div>
<p>The attribute <tt class="docutils literal"><span class="pre">vasp.encut</span></tt> is (in this case) an integer which can be
manipulated as any other python integer. Any python object can be given. It
will appear in the INCAR as it appears when transformed to a string (using
python&#8217;s <a class="reference external" href="http://docs.python.org/2/library/functions.html#str">str</a> function).</p>
<p>If you do <em>not</em> want a parameter printed to the INCAR, i.e. you want to use the
<a class="reference external" href="http://www.vasp.at/">VASP</a> default for that parameter, then simply set that parameter to <tt class="docutils literal"><span class="pre">None</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vasp</span><span class="o">.</span><span class="n">encut</span> <span class="o">=</span> <span class="bp">None</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The examples above specifies a parameter which already exists,
<tt class="xref py py-attr docutils literal"><span class="pre">encut</span></tt>.  In this case, when calling
<tt class="xref py py-meth docutils literal"><span class="pre">add_keyword()</span></tt>,  the parameter is replaced
with a simple integer (or float, or whatnot).  Its special behavior
described above is simply gone.  If you do not like a special behavior, you
can always do away with it.</p>
</div>
</div>
<div class="section" id="specifying-kpoints">
<h2>Specifying kpoints<a class="headerlink" href="#specifying-kpoints" title="Permalink to this headline">¶</a></h2>
<p>K-points can be specified in  a variety of ways.</p>
<p>Simply as a <a class="reference external" href="http://cms.mpi.univie.ac.at/wiki/index.php/KPOINTS">KPOINTS</a> file in string:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vasp</span><span class="o">.</span><span class="n">kpoints</span> <span class="o">=</span> <span class="s">&quot;Automatic generation</span><span class="se">\n</span><span class="s">0</span><span class="se">\n</span><span class="s">Monkhorst</span><span class="se">\n</span><span class="s">2 2 2</span><span class="se">\n</span><span class="s">0 0 0&quot;</span>
</pre></div>
</div>
<p>As a 4xn matrix where the first three components of each row define a single
kpoint in <em>cartesian</em> coordinates, and the last component its multiplicity. In
that case, <a class="reference external" href="http://www.vasp.at/">VASP</a> does not reduce the kpoints by symmetry, as explained <a class="reference external" href="KPOINTS">here</a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vasp</span><span class="o">.</span><span class="n">kpoints</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="p">]</span>
</pre></div>
</div>
<p>As a callable function which takes the vasp functional and the structure as
input. It must return either a string defining a semantically correct <a class="reference external" href="http://cms.mpi.univie.ac.at/wiki/index.php/KPOINTS">KPOINTS</a>
file, or an array of kpoints as above.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">some_function</span><span class="p">(</span><span class="n">functional</span><span class="p">,</span> <span class="n">structure</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="o">....</span> <span class="n">do</span> <span class="n">something</span>
<span class="gp">&gt;&gt;&gt; </span>  <span class="k">return</span> <span class="n">kpoints</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vasp</span><span class="o">.</span><span class="n">kpoints</span> <span class="o">=</span> <span class="n">some_function</span>
</pre></div>
</div>
<p>This function is called before each execution. Hence the kpoint grid can be
tailored to each call.</p>
</div>
<div class="section" id="specifying-the-pseudos-and-hubbard-u-parameters">
<h2>Specifying the pseudos and Hubbard U parameters<a class="headerlink" href="#specifying-the-pseudos-and-hubbard-u-parameters" title="Permalink to this headline">¶</a></h2>
<p>Pseudo-potentials must be specified explicitely:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vasp</span><span class="o">.</span><span class="n">add_specie</span> <span class="o">=</span> <span class="s">&#39;Tc&#39;</span><span class="p">,</span> <span class="s">&#39;/path/to/pseudo/directory/Tc&#39;</span>
</pre></div>
</div>
<p>The first item is the name of the atomic specie. It corresponds to the type of
the atom in the structure to compute. The second item is a path to a directory
where the appropriate <em>unzipped</em> POTCAR resides. It will not affect calculations.
For convenience, the path may be given with the usual unix short-cuts and/or with
a shell environment variable.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vasp</span><span class="o">.</span><span class="n">add_specie</span> <span class="o">=</span> <span class="s">&#39;Tc&#39;</span><span class="p">,</span> <span class="s">&#39;~/pseudos/$PAW/Tc&#39;</span>
</pre></div>
</div>
<p>To specify a Hubbard U parameter, do:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pylada.vasp.specie</span> <span class="kn">import</span> <span class="n">U</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vasp</span><span class="o">.</span><span class="n">add_specie</span> <span class="o">=</span> <span class="s">&#39;Tc&#39;</span><span class="p">,</span> <span class="s">&#39;~/pseudos/$PAW/Tc&#39;</span><span class="p">,</span> <span class="n">U</span><span class="p">(</span><span class="s">&#39;dudarev&#39;</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
</pre></div>
</div>
<p>The species can be latter accessed through a dictionary in the vasp object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vasp</span><span class="o">.</span><span class="n">add_specie</span> <span class="o">=</span> <span class="s">&#39;Tc&#39;</span><span class="p">,</span> <span class="s">&#39;~/pseudos/$PAW/Tc&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">vasp</span><span class="p">[</span><span class="s">&#39;Tc&#39;</span><span class="p">]</span>
<span class="go">Specie(&#39;Tc&#39;, &#39;~/pseudos/$PAW/Tc&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vasp</span><span class="p">[</span><span class="s">&#39;Tc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">moment</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
<p>At which point, other elemental properties could be added for latter use in a
script.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is possible to specify more species than exists in a given structure.
Pylada will figure out at runtime.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Creating and Setting up the vasp functional</a><ul>
<li><a class="reference internal" href="#specifying-vasp-parameters">Specifying vasp parameters</a></li>
<li><a class="reference internal" href="#adding-parameters-pylada-does-not-know-about">Adding parameters Pylada does not know about</a></li>
<li><a class="reference internal" href="#specifying-kpoints">Specifying kpoints</a></li>
<li><a class="reference internal" href="#specifying-the-pseudos-and-hubbard-u-parameters">Specifying the pseudos and Hubbard U parameters</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="reading.html"
                        title="previous chapter">Reading from pre-existing VASP files</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="running.html"
                        title="next chapter">Executing a VASP calculation</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/userguide/vasp/creating.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="running.html" title="Executing a VASP calculation"
             >next</a> |</li>
        <li class="right" >
          <a href="reading.html" title="Reading from pre-existing VASP files"
             >previous</a> |</li>
        <li><a href="../../index.html">Pylada 1.0 documentation</a> &raquo;</li>
          <li><a href="../../userguide.html" >User Guide</a> &raquo;</li>
          <li><a href="../vasp.html" >Interface to VASP</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Mayeul d&#39;Avezac.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>