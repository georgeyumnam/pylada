

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>A meta-functional: Strain relaxation &mdash; Pylada 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="top" title="Pylada 1.0 documentation" href="../../index.html" />
    <link rel="up" title="Interface to VASP" href="../vasp.html" />
    <link rel="next" title="Example: Epitaxial relaxation method" href="example.html" />
    <link rel="prev" title="Extracting results from VASP calculations" href="extract.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="example.html" title="Example: Epitaxial relaxation method"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="extract.html" title="Extracting results from VASP calculations"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">Pylada 1.0 documentation</a> &raquo;</li>
          <li><a href="../../userguide.html" >User Guide</a> &raquo;</li>
          <li><a href="../vasp.html" accesskey="U">Interface to VASP</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="a-meta-functional-strain-relaxation">
<span id="vasp-relax-ug"></span><h1>A <em>meta</em>-functional: Strain relaxation<a class="headerlink" href="#a-meta-functional-strain-relaxation" title="Permalink to this headline">Â¶</a></h1>
<p>Relaxing structures generally takes a few actual VASP calculations, since the
FFT and pseudo-potential grids are not adapted to changing cell parameters and
ionic positions. It&#8217;s brain-dead work best handled automatically. Pylada
currently provides two relaxation methods: <tt class="xref py py-class docutils literal"><span class="pre">relax.Relax</span></tt> and
<tt class="xref py py-class docutils literal"><span class="pre">relax.Epitaxial</span></tt>. The former handles general relaxation, including
cellshape, volume, and ionic positions, while the latter performs relaxation on
a virtual substrate (e.g. for coherent Germanium on a (001)&#64;Si substrate, only
the out-of-plane parameter should be relaxed, while the in-plane are fixed to
Si).  The following only describes the first case.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># create the functional</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pylada.vasp</span> <span class="kn">import</span> <span class="n">Relax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">functional</span> <span class="o">=</span> <span class="n">Relax</span><span class="p">(</span><span class="n">relaxation</span><span class="o">=</span><span class="s">&#39;cellshape volume ions&#39;</span><span class="p">,</span> <span class="n">maxcalls</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">keepsteps</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">functional</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span>
</pre></div>
</div>
<p>The above creates the functional and launches the calculations. It will first
proceed by relaxing everything, e.g. both cell-shape and ions, if cell-shape
and ionic relaxation are requested. Once convergence is achived, it locks the
cell-shape and relaxes the ions only. Finally, it performs a final static
calculation for maximum accuracy.</p>
<p>The functional is derived from <tt class="xref py py-class docutils literal"><span class="pre">Vasp</span></tt>. In practice, this
means that whatever works for <tt class="xref py py-class docutils literal"><span class="pre">Vasp</span></tt> works for
<tt class="xref py py-class docutils literal"><span class="pre">Relax</span></tt>. However, it does accept a few extra attributes,
described below:</p>
<blockquote>
<div><dl class="docutils">
<dt>first_trial</dt>
<dd>A dictionary with parameters which are used only for the very first
VASP calculation. It can be used to accelerate the first step of the
relaxation if starting far from the optimum. For instance, it could be
<tt class="docutils literal"><span class="pre">{'encut':</span> <span class="pre">0.8}</span></tt> to first converge the structure with a smaller
cutoff. Defaults to empty dictionary.</dd>
<dt>maxcalls</dt>
<dd>An interger which denotes the maximum number of calls to VASP before
aborting. Defaults to 10.</dd>
<dt>keepsteps</dt>
<dd>If True, intermediate steps are kept. If False, intermediate steps are
erased.</dd>
<dt>relaxation</dt>
<dd>Degrees of freedom to relax. It should be either &#8220;cellshape&#8221; or &#8220;ionic&#8221;
or both. Same as for <tt class="xref py py-class docutils literal"><span class="pre">Vasp</span></tt>.</dd>
<dt>nofail</dt>
<dd>If True, will not fail if convergence is not achieved. Just keeps going.
Defaults to False.</dd>
<dt>convergence</dt>
<dd><p class="first">Convergence criteria. If <tt class="docutils literal"><span class="pre">minrelsteps</span></tt> is positive, it is only
checked after <tt class="docutils literal"><span class="pre">minrelsteps</span></tt> have been performed. Convergence is
checked according to last VASP run, not from one VASP run to another.
Eg. If a positive real number, convergence is achieved when the
difference between the last two total-energies of the current run fall
below that real number (times structure size), not when the total
energies of the last two runs fall below that number. Faster, but
possibly less safe.</p>
<ul class="last simple">
<li>None: defaults to <tt class="docutils literal"><span class="pre">vasp.ediff</span> <span class="pre">*</span> <span class="pre">1e1</span></tt></li>
<li>positive real number: energy convergence criteria in eV per atom.</li>
<li>negative real number: force convergence criteria in eV/angstrom.</li>
<li>callable: Takes an extraction object as input. Should return True if
convergence is achieved and False otherwise.</li>
</ul>
</dd>
</dl>
<p>minrelsteps</p>
<blockquote>
<div><p>Fine tunes how convergence criteria is applied.</p>
<ul class="simple">
<li>positive: at least <tt class="docutils literal"><span class="pre">minrelsteps</span></tt> calls to VASP are performed before
checking for convergence. If <tt class="docutils literal"><span class="pre">relaxation</span></tt> contains &#8220;cellshape&#8221;,
then these calls occur during cellshape relaxation. If it does not,
then the calls occur during the ionic relaxations. The calls do count
towards <tt class="docutils literal"><span class="pre">maxcalls</span></tt>.</li>
<li>negative (default): argument is ignored.</li>
</ul>
</div></blockquote>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There is also a function <tt class="xref py py-func docutils literal"><span class="pre">relax.relax()</span></tt>, which does the exact same
thing as the class. Whether to use one or the other is a matter of taste.
And there&#8217;s also a generator <tt class="xref py py-func docutils literal"><span class="pre">relax.iter_relax()</span></tt> over actual calls
to the <a class="reference external" href="http://www.vasp.at/">VASP</a> binary.  Internally, it allows Pylada to launch different
relaxations from different calculations side by side. In practice, both
<tt class="xref py py-func docutils literal"><span class="pre">relax.relax()</span></tt> and <tt class="xref py py-class docutils literal"><span class="pre">relax.Relax</span></tt> make calls to
<tt class="xref py py-func docutils literal"><span class="pre">relax.iter_relax()</span></tt>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="extract.html"
                        title="previous chapter">Extracting results from VASP calculations</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="example.html"
                        title="next chapter">Example: Epitaxial relaxation method</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/userguide/vasp/relax.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="example.html" title="Example: Epitaxial relaxation method"
             >next</a> |</li>
        <li class="right" >
          <a href="extract.html" title="Extracting results from VASP calculations"
             >previous</a> |</li>
        <li><a href="../../index.html">Pylada 1.0 documentation</a> &raquo;</li>
          <li><a href="../../userguide.html" >User Guide</a> &raquo;</li>
          <li><a href="../vasp.html" >Interface to VASP</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Mayeul d&#39;Avezac.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>